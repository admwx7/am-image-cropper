<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>am-image-cropper demo</title>

    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>

    <link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
    <link rel="import" href="../../iron-demo-helpers/demo-snippet.html">
    <link rel="import" href="../am-image-cropper.html">

    <custom-style>
      <style is="custom-style" include="demo-pages-shared-styles">
        #container {
          display: inline-block;
          position: relative; /* Used to restrict the bounds of the cropper */
          border: 1px solid #E0374C;
          user-select: none;
        }
        #image {
          display: block;
        }
        #cropper:not([show]) {
          display: none;
        }
      </style>
    </custom-style>
  </head>
  <body>
    <div class="vertical-section-container centered">
      <h3>Basic am-image-cropper demo</h3>
      <demo-snippet>
        <template>
          <!-- TODO: crossOrigin shouldn't be required but it's getting "tainted" for some reason, local issue only? -->
          <div id="container">
            <img id="image"
              crossOrigin="Anonymous"
              src="https://picsum.photos/200/300"
              draggable="false"
            />
            <am-image-cropper id="cropper"
            ></am-image-cropper>
          </div>
          <br />
          <button id="button">Crop</button>
          <div id="croppedImages"></div>

          <script>
            const button = document.getElementById('button');
            const croppedImages = document.getElementById('croppedImages');
            const cropper = document.getElementById('cropper');
            const image = document.getElementById('image');
            button.addEventListener('click', () => {
              const imgUrl = cropper.crop(image).toDataURL('image/png');
              const croppedImage = document.createElement('img');
              croppedImage.src = imgUrl;
              croppedImages.appendChild(croppedImage);
            });
            image.addEventListener('load', () => {
              cropper.setAttribute('show', '');
            });
          </script>
        </template>
      </demo-snippet>
    </div>
  </body>
</html>
